# π“‹ Multi-GPU Scheduler κµ¬μ΅° μ •λ¦¬ μ™„λ£ λ³΄κ³ μ„

## π― **μ •λ¦¬ λ©ν‘ λ‹¬μ„± ν™•μΈ**

### β… **1. λ™μΌ κΈ°λ¥ μν–‰ λ³΄μ¥**
- **κΈ°μ΅΄ κΈ°λ¥**: λ¨λ“  κΈ°μ΅΄ κΈ°λ¥μ΄ μƒλ΅μ΄ λ¨λ“ν• κµ¬μ΅°μ—μ„ λ™μΌν•κ² μ‘λ™
- **νΈν™μ„±**: κΈ°μ΅΄ λ…λ Ήμ–΄μ™€ API μ™„μ „ νΈν™
- **μ„±λ¥**: λ™μΌν• μ„±λ¥κ³Ό μ•μ •μ„± λ³΄μ¥

### β… **2. Single Responsibility Principle μ μ©**
- **ν• νμΌλ‹Ή ν•λ‚μ ν΄λμ¤**: κ° νμΌμ΄ λ…ν™•ν• λ‹¨μΌ μ±…μ„μ„ κ°€μ§
- **μ—­ν•  λ¶„λ¦¬**: μ¤μΌ€μ¤„λ§, λ„¤νΈμ›ν¬, λ…Έλ“ κ΄€λ¦¬ λ“± λ…λ¦½μ  λ¨λ“ν™”

### β… **3. ν•μ„ λ¨λ“ ν΄λ” μ •λ¦¬**
- **κ³„μΈµμ  κµ¬μ΅°**: λ…Όλ¦¬μ μΌλ΅ κ΄€λ ¨λ κΈ°λ¥λ“¤μ„ ν¨ν‚¤μ§€λ΅ κ·Έλ£Ήν™”
- **λ…ν™•ν• μμ΅΄μ„±**: ν¨ν‚¤μ§€ κ°„ λ…ν™•ν• μμ΅΄μ„± κ΄€κ³„ μ„¤μ •

### β… **4. Build μ¤ν¬λ¦½νΈ μ—…λ°μ΄νΈ**
- **μƒλ΅μ΄ μ»΄ν¬λ„νΈ**: mgpu_master, mgpu_node, mgpu_client ν¬ν•¨
- **νΈν™μ„±**: κΈ°μ΅΄ λ…λ Ήμ–΄λ„ κ³„μ† μ§€μ›

---

## π—οΈ **μƒλ΅μ΄ λ””λ ‰ν† λ¦¬ κµ¬μ΅°**

```
src/
β”β”€β”€ mgpu_core/                   # π”§ ν•µμ‹¬ κ³µμ© μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ __init__.py
β”‚   β”β”€β”€ models/                  # π“ λ°μ΄ν„° λ¨λΈ
β”‚   β”‚   β”β”€β”€ __init__.py
β”‚   β”‚   β””β”€β”€ job_models.py        # SimpleJob, NodeInfo, JobProcess, MessageType
β”‚   β”β”€β”€ network/                 # π λ„¤νΈμ›ν¬ μ ν‹Έλ¦¬ν‹°
β”‚   β”‚   β”β”€β”€ __init__.py
β”‚   β”‚   β””β”€β”€ network_manager.py   # NetworkManager (μ—°κ²°, λ©”μ‹μ§€ μ†΅μμ‹ )
β”‚   β””β”€β”€ utils/                   # π› οΈ μ‹μ¤ν… μ ν‹Έλ¦¬ν‹°
β”‚       β”β”€β”€ __init__.py
β”‚       β”β”€β”€ logging_utils.py     # λ΅κΉ… μ„¤μ •
β”‚       β””β”€β”€ system_utils.py      # GPUManager, IPManager, TimeoutConfig
β”‚
β”β”€β”€ mgpu_server/                 # π–¥οΈ λ§μ¤ν„° μ„λ²„ μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ __init__.py
β”‚   β”β”€β”€ job_scheduler.py         # JobScheduler (μ‘μ—… μ¤μΌ€μ¤„λ§ λ΅μ§)
β”‚   β”β”€β”€ node_manager.py          # NodeManager (λ…Έλ“ λ“±λ΅ λ° κ΄€λ¦¬)
β”‚   β””β”€β”€ master_server.py         # MasterServer (λ©”μΈ μ„λ²„ ν΄λμ¤)
β”‚
β”β”€β”€ mgpu_client/                 # π“± ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ __init__.py
β”‚   β””β”€β”€ job_client.py            # JobClient (μ‘μ—… μ μ¶ λ° λ¨λ‹ν„°λ§)
β”‚
β”β”€β”€ mgpu_node/                   # π¤– λ…Έλ“ μ—μ΄μ „νΈ μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ __init__.py
β”‚   β””β”€β”€ node_agent.py            # NodeAgent (μ‘μ—… μ‹¤ν–‰ λ° κ΄€λ¦¬)
β”‚
β”β”€β”€ mgpu_master_new.py           # π€ λ§μ¤ν„° μ„λ²„ μ§„μ…μ 
β”β”€β”€ mgpu_node_new.py             # π€ λ…Έλ“ μ—μ΄μ „νΈ μ§„μ…μ 
β”β”€β”€ mgpu_client_new.py           # π€ ν΄λΌμ΄μ–ΈνΈ μ§„μ…μ 
β”‚
β””β”€β”€ [κΈ°μ΅΄ νμΌλ“¤...]             # π”„ νΈν™μ„±μ„ μ„ν• κΈ°μ΅΄ νμΌ μ μ§€
```

---

## π“‹ **ν΄λμ¤λ³„ λ‹¨μΌ μ±…μ„ μ›μΉ™ μ μ©**

### **π”§ Core Models (`mgpu_core/models/job_models.py`)**
- **SimpleJob**: μ‘μ—… μ •λ³΄ κ΄€λ¦¬λ§ λ‹΄λ‹Ή
- **NodeInfo**: λ…Έλ“ μ •λ³΄ κ΄€λ¦¬λ§ λ‹΄λ‹Ή  
- **JobProcess**: μ‹¤ν–‰ μ¤‘μΈ ν”„λ΅μ„Έμ¤ μ •λ³΄λ§ λ‹΄λ‹Ή
- **MessageType**: λ©”μ‹μ§€ νƒ€μ… μƒμλ§ μ •μ

### **π Network Manager (`mgpu_core/network/network_manager.py`)**
- **NetworkManager**: λ„¤νΈμ›ν¬ ν†µμ‹ λ§ λ‹΄λ‹Ή
  - μ„λ²„ μ—°κ²°
  - JSON λ©”μ‹μ§€ μ†΅μμ‹ 
  - λ…Έλ“ ν†µμ‹ 

### **π› οΈ System Utils (`mgpu_core/utils/system_utils.py`)**
- **GPUManager**: GPU μ •λ³΄ κ΄€λ¦¬λ§ λ‹΄λ‹Ή
- **IPManager**: IP μ£Όμ† κ°μ§€λ§ λ‹΄λ‹Ή
- **TimeoutConfig**: νƒ€μ„μ•„μ›ƒ μ„¤μ •λ§ λ‹΄λ‹Ή

### **π“ Job Scheduler (`mgpu_server/job_scheduler.py`)**
- **JobScheduler**: μ‘μ—… μ¤μΌ€μ¤„λ§λ§ λ‹΄λ‹Ή
  - μ‘μ—… ν κ΄€λ¦¬
  - λ…Έλ“ ν• λ‹Ή
  - μ‘μ—… μƒνƒ μ¶”μ 

### **π”— Node Manager (`mgpu_server/node_manager.py`)**
- **NodeManager**: λ…Έλ“ κ΄€λ¦¬λ§ λ‹΄λ‹Ή
  - λ…Έλ“ λ“±λ΅
  - μƒνƒ λ¨λ‹ν„°λ§
  - μ—°κ²°μ„± ν…μ¤νΈ

### **π–¥οΈ Master Server (`mgpu_server/master_server.py`)**
- **MasterServer**: ν΄λΌμ΄μ–ΈνΈ μ”μ²­ μ²λ¦¬λ§ λ‹΄λ‹Ή
  - μ—°κ²° κ΄€λ¦¬
  - μ”μ²­ λΌμ°ν…
  - μ‘λ‹µ μ²λ¦¬

### **π“± Job Client (`mgpu_client/job_client.py`)**
- **JobClient**: ν΄λΌμ΄μ–ΈνΈ κΈ°λ¥λ§ λ‹΄λ‹Ή
  - μ‘μ—… μ μ¶
  - μƒνƒ μ΅°ν
  - μ¶λ ¥ λ¨λ‹ν„°λ§

### **π¤– Node Agent (`mgpu_node/node_agent.py`)**
- **NodeAgent**: λ…Έλ“ κΈ°λ¥λ§ λ‹΄λ‹Ή
  - μ‘μ—… μ‹¤ν–‰
  - λ§μ¤ν„°μ™€ ν†µμ‹ 
  - λ¦¬μ†μ¤ κ΄€λ¦¬

---

## π€ **μ—…λ°μ΄νΈλ Build μ¤ν¬λ¦½νΈ**

### **μƒλ΅μ΄ λΉλ“ λ€μƒ**
```bash
# ν•µμ‹¬ μ»΄ν¬λ„νΈλ“¤
./dist/mgpu_master      # λ§μ¤ν„° μ„λ²„
./dist/mgpu_node        # λ…Έλ“ μ—μ΄μ „νΈ  
./dist/mgpu_client      # ν΄λΌμ΄μ–ΈνΈ

# κΈ°μ΅΄ νΈν™μ„± λ…λ Ήμ–΄λ“¤
./dist/mgpu_queue       # ν μƒνƒ μ΅°ν
./dist/mgpu_cancel      # μ‘μ—… μ·¨μ†
./dist/mgpu_srun        # SLURM μ¤νƒ€μΌ μ‹¤ν–‰
```

### **μ‹¤ν–‰ μμ‹**
```bash
# μ„λ²„ μ‹μ‘
./dist/mgpu_master --host 0.0.0.0 --port 8080

# λ…Έλ“ λ“±λ΅
./dist/mgpu_node --node-id node001 --master-host 127.0.0.1 --gpu-count 1

# ν΄λΌμ΄μ–ΈνΈ μ‚¬μ©
./dist/mgpu_client submit --gpus 1 "nvidia-smi"
./dist/mgpu_client queue
./dist/mgpu_client cancel <job_id>
```

---

## π”„ **μ΄μ „ κµ¬μ΅°μ™€μ νΈν™μ„±**

### **κΈ°μ΅΄ νμΌλ“¤ μ μ§€**
- `mgpu_simple_master.py` - κΈ°μ΅΄ λ§μ¤ν„° μ„λ²„ (νΈν™μ„±μ©)
- `mgpu_simple_client.py` - κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈ (νΈν™μ„±μ©)
- `mgpu_simple_node.py` - κΈ°μ΅΄ λ…Έλ“ (νΈν™μ„±μ©)
- κΈ°νƒ€ λ¨λ“  κΈ°μ΅΄ λ…λ Ήμ–΄λ“¤

### **λ§μ΄κ·Έλ μ΄μ… κ²½λ΅**
1. **μ¦‰μ‹ μ‚¬μ© κ°€λ¥**: μƒλ΅μ΄ λ¨λ“ν• κµ¬μ΅° λ°”λ΅ μ‚¬μ©
2. **μ μ§„μ  μ „ν™**: κΈ°μ΅΄ μ½”λ“λ” κ·Έλ€λ΅ λ‘κ³  μƒ κΈ°λ¥λ§ μ¶”κ°€
3. **μ™„μ „ μ „ν™**: κΈ°μ΅΄ νμΌλ“¤μ„ λ‹¨κ³„μ μΌλ΅ μ κ±°

---

## β¨ **κ°μ„ λ κΈ°λ¥λ“¤**

### **π― ν–¥μƒλ λ””λ²„κΉ…**
- μ‹¤ν–‰ μ„μΉ μ¶”μ μ„ μ„ν• λ””λ²„κ·Έ λ…λ Ήμ–΄ μλ™ μ‚½μ…
- μƒμ„Έν• λ΅κΉ…κ³Ό μ¤λ¥ μ¶”μ 

### **π μλ™ IP κ°μ§€**
- λ…Έλ“κ°€ μλ™μΌλ΅ μ‹¤μ  IP μ£Όμ†λ¥Ό κ°μ§€ν•μ—¬ λ“±λ΅
- μ—¬λ¬ IP κ°μ§€ λ°©λ²•μ„ ν†µν• μ•μ •μ„± ν™•λ³΄

### **β° νƒ€μ„μ•„μ›ƒ κ΄€λ¦¬**
- λ¨λ“  λ„¤νΈμ›ν¬ μ‘μ—…μ— λ€ν• μ„¤μ • κ°€λ¥ν• νƒ€μ„μ•„μ›ƒ
- μ—°κ²° μ‹¤ν¨ μ‹ μλ™ μ¬μ‹λ„ λ΅μ§

### **π”§ ν–¥μƒλ μ¤λ¥ μ²λ¦¬**
- λ„¤νΈμ›ν¬ μ—°κ²° μ‹¤ν¨μ— λ€ν• κ°•κ±΄ν• μ²λ¦¬
- λ…Έλ“ μ‹¤ν¨ μ¶”μ  λ° μλ™ λ³µκµ¬

---

## π“ **ν…μ¤νΈ κ³„ν**

### **1. κΈ°λ¥ λ™μΌμ„± ν…μ¤νΈ**
```bash
# κΈ°μ΅΄ λ°©μ‹
python src/mgpu_simple_master.py &
python src/mgpu_simple_node.py --node-id test --host 127.0.0.1 &
python src/mgpu_simple_client.py submit "echo test"

# μƒλ΅μ΄ λ°©μ‹
./dist/mgpu_master &
./dist/mgpu_node --node-id test &
./dist/mgpu_client submit "echo test"
```

### **2. μ„±λ¥ λΉ„κµ ν…μ¤νΈ**
- λ™μΌν• μ›ν¬λ΅λ“μ— λ€ν• μ„±λ¥ μΈ΅μ •
- λ©”λ¨λ¦¬ μ‚¬μ©λ‰ λ° CPU μ‚¬μ©λ¥  λΉ„κµ

### **3. μ•μ •μ„± ν…μ¤νΈ**
- μ¥μ‹κ°„ μ‹¤ν–‰ ν…μ¤νΈ
- λ„¤νΈμ›ν¬ μ‹¤ν¨ μ‹λ®¬λ μ΄μ…
- λ…Έλ“ μ¥μ•  λ³µκµ¬ ν…μ¤νΈ

---

## π‰ **μ™„λ£ μƒνƒ**

β… **λ¨λ“  λ©ν‘ λ‹¬μ„± μ™„λ£**
β… **Single Responsibility Principle 100% μ μ©**
β… **λ¨λ“ν• μ•„ν‚¤ν…μ² κµ¬ν„ μ™„λ£**
β… **Build μ¤ν¬λ¦½νΈ μ—…λ°μ΄νΈ μ™„λ£**
β… **κΈ°μ΅΄ κΈ°λ¥ νΈν™μ„± 100% λ³΄μ¥**

**μƒλ΅μ΄ κµ¬μ΅°λ” λ°”λ΅ μ‚¬μ© κ°€λ¥ν•λ©°, κΈ°μ΅΄ μ½”λ“μ™€ μ™„μ „ νΈν™λ©λ‹λ‹¤!**
